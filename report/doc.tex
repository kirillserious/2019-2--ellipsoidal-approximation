\input{formats/report}
\input{set}
\input{decl}
\begin{document}
\input{title_page/doc}
\tableofcontents
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%        


%%  Document start


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Об эллипсоидах и сумме Минковского}

\begin{definition}
        Назовём \textit{эллипсоидом} множество
$$
        \mathcal{E}(q,\,Q) = \{
x \in \setR^n \,:\, \langle x-q,\,Q^{-1}(x-q) \rangle \leqslant 1
        \},
        \qquad \mbox{где } Q= Q\T > 0.
$$
\end{definition}

\begin{assertion}
        Опорная функция и опорный вектор эллипсоида имеют вид:
$$
        \rho(l\,|\,\Varepsilon(q,\,Q)) =
        \langle l,\,q \rangle + 
        \langle l,\,Ql \rangle^{\nicefrac{1}{2}},
$$
$$
        x(l) = q + \frac{Ql}{\langle l,\,Ql\rangle^{\nicefrac12}}.
$$
\end{assertion}
\begin{proof}

Будем доказывать для случая $q = 0$. Иначе --- аналогично.

Так как по определению
$
        \rho(l\,|\,A) = \sup_{x\in A}\langle l,\,x\rangle,
$
то мы должны решать задачу максимизации скалярного произведения
$
        \langle l,\,x \rangle
$
при условии, что
$
        \langle x,\,Q^{-1}x \rangle = 1.
$
Запишем функцию Лагранжа для этой задачи:
$$
        \mathcal{L}(l,\,x,\,\lambda)
        =
        \langle l,\,x \rangle
        +
        \lambda(\langle x,\,Q^{-1}x \rangle - 1).
$$
Тогда
$$
        \frac{\partial \mathcal{L}}{\partial x}
        =
        l + 2\lambda Q^{-1} x 
        = 0
        \quad
        \Longrightarrow
        \quad
        x(l) = -\frac{1}{2\lambda}Ql.
$$
Подставим получившееся выражение для опорного вектора в условие:
$$
        \left\langle
-\frac{1}{2\lambda}Ql
,\,
-\frac{1}{2\lambda}Q^{-1}Ql
        \right\rangle
        = 1
        \;\Longrightarrow\;
        \lambda
        =
        -\frac12 \langle l,\,Ql \rangle^{\nicefrac12}
        \,\Longrightarrow\,
        x(l) = \frac{Ql}{\langle l,\,Ql\rangle^{\nicefrac12}}.
$$
В таком случае опорная функция в направлении $l \neq 0$ равна
$$
        \rho(l\,|\,\Varepsilon(0,\,Q))
        =
        \left\langle
l
,\,
\frac{Ql}{\langle l,\,Ql\rangle^{\nicefrac12}}
        \right\rangle
        =
        \langle l,\,Ql \rangle^{\nicefrac{1}{2}}.
$$
\end{proof}

\begin{definition}
        \textit{Суммой Минковского} множеств $A$ и $B$ называется множество
$$
        A + B
        =
        \{\,
x = a + b \::\: a \in A,\,b \in B 
        \,\}.
$$
\end{definition}

\begin{assertion}
        Опорная функция суммы Минковского равна сумме опорных функций каждого из множеств, то есть
$$
        \rho\left(l\,\left|\,\sum_{i=1}^n A_i\right.\right) = \sum_{i=1}^n \rho\,(l\,|\,A_i).
$$
\end{assertion}
\clearpage
\begin{figure}[t]
        \centering
        \input{img/ellipse}
        \caption{Эллипсоид с центром $q = \protect\begin{bmatrix}1\\2\protect\end{bmatrix}$ и матрицей $Q = \protect\begin{bmatrix}5&3\\3&2\protect\end{bmatrix}.$}
\end{figure}
\begin{figure}[b]
        \centering
        \input{img/sum_ellipse}
        \caption{Сумма двух эллипсоидов.}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\section{Внешняя оценка суммы эллипсоидов}

\begin{theorem}
        Для суммы Минковского эллипсоидов справедлива следующая внешняя оценка
$$
        \sum\limits_{i=1}^{n} \Varepsilon(q_i,\,Q_i)
        =
        \bigcap\limits_{\| l \| = 1} \Varepsilon(q_+(l),\,Q_+(l)),
$$
где
$$
        \begin{aligned}
q_+(l) &= \sum_{i=1}^{n} q_i,
\\
Q_+(l) &= \sum_{i=1}^n p_i \cdot \sum_{i=1}^{n} \frac{Q_i}{p_i},
\quad
\mbox{где }
p_i = \langle l,\,Q_i l \rangle^{\nicefrac12}.
        \end{aligned}
$$
\end{theorem}

\begin{proof}

Будем доказывать для случая $q_i = 0,$ $i = \overline{1,\,n}$. Случай с произвольными центрами~--- аналогично.

Распишем квадрат опорной функции эллипсоида $\Varepsilon(0,\,Q_+(l))$:
\begin{multline*}
        \rho^2(l\,|\,\Varepsilon(0,\,Q_+(l)))
        =
        \sum_{i=1}^{n}
        \langle
        l,\,Q_il
        \rangle
        +
        \sum_{i < j}
        \left\langle
l,\,\left(
\frac{p_i}{p_j}Q_j + \frac{p_j}{p_i}Q_i
\right)l
        \right\rangle
        \geqslant\\\geqslant
        \left\{
\frac{a+b}{2} \geqslant \sqrt{ab}
        \right\}
        \geqslant
        \sum_{i=1}^{n}\langle l,\,Ql \rangle
        +
        2\sum_{i < j}
        \langle l,\,Q_il \rangle^{\nicefrac12}
        \langle l,\,Q_jl \rangle^{\nicefrac12}
        =\\=
        \left(
\sum_{i=1}^n\langle l,\,Q_il\rangle^{\nicefrac12}
        \right)^2
        =
        \rho^2\left(
l\left|
        \sum_{i=1}^n\Varepsilon(0, Q_i)
\right.
        \right).
\end{multline*}
Таким образом, получили, что для любого $l \neq 0$
$$
        \sum_{i=1}^n \Varepsilon(0,\,Q_i) \subseteq \Varepsilon(0,\,Q_+(l)),
$$
причем, так как равенство опорных функций достигается при
$
        p_i = \langle l,\,Q_i l \rangle^{\nicefrac12},
$
то в направлении $l \neq 0$ эллипсоид $\Varepsilon(0,\,Q_+)$ касается суммы $\sum_{i = 0}^{n} \Varepsilon(0,\,Q_i).$

\end{proof}

\clearpage
\begin{figure}[t]
        \centering
        \input{img/outer_sum_10}
        \caption{Эллипсоидальные аппроксимации для 10 направлений.}
\end{figure}
\begin{figure}[b]
        \centering
        \input{img/outer_sum_100}
        \caption{Эллипсоидальные аппроксимации для 100 направлений.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Document end


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\begin{thebibliography}{9}
\input{bib}
\end{thebibliography}
\end{document}