\input{formats/report}
\input{set}
\input{decl}
\begin{document}
\input{title_page/doc}
\tableofcontents
\clearpage
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%        


%%  Document start


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Об эллипсоидах и сумме Минковского}

\begin{definition}
        Назовём \textit{эллипсоидом} множество
$$
        \mathcal{E}(q,\,Q) = \{
x \in \setR^n \,:\, \langle x-q,\,Q^{-1}(x-q) \rangle \leqslant 1
        \},
        \qquad \mbox{где } Q= Q\T > 0.
$$
\end{definition}

\begin{assertion}
        Опорная функция и опорный вектор эллипсоида имеют вид:
$$
        \rho(l\,|\,\Varepsilon(q,\,Q)) =
        \langle l,\,q \rangle + 
        \langle l,\,Ql \rangle^{\nicefrac{1}{2}},
$$
$$
        x(l) = q + \frac{Ql}{\langle l,\,Ql\rangle^{\nicefrac12}}.
$$
\end{assertion}
\begin{proof}

Будем доказывать для случая $q = 0$. Иначе --- аналогично.

Так как по определению
$
        \rho(l\,|\,A) = \sup_{x\in A}\langle l,\,x\rangle,
$
то мы должны решать задачу максимизации скалярного произведения
$
        \langle l,\,x \rangle
$
при условии, что
$
        \langle x,\,Q^{-1}x \rangle = 1.
$
Запишем функцию Лагранжа для этой задачи:
$$
        \mathcal{L}(l,\,x,\,\lambda)
        =
        \langle l,\,x \rangle
        +
        \lambda(\langle x,\,Q^{-1}x \rangle - 1).
$$
Тогда
$$
        \frac{\partial \mathcal{L}}{\partial x}
        =
        l + 2\lambda Q^{-1} x 
        = 0
        \quad
        \Longrightarrow
        \quad
        x(l) = -\frac{1}{2\lambda}Ql.
$$
Подставим получившееся выражение для опорного вектора в условие:
$$
        \left\langle
-\frac{1}{2\lambda}Ql
,\,
-\frac{1}{2\lambda}Q^{-1}Ql
        \right\rangle
        = 1
        \;\Longrightarrow\;
        \lambda
        =
        -\frac12 \langle l,\,Ql \rangle^{\nicefrac12}
        \,\Longrightarrow\,
        x(l) = \frac{Ql}{\langle l,\,Ql\rangle^{\nicefrac12}}.
$$
В таком случае опорная функция в направлении $l \neq 0$ равна
$$
        \rho(l\,|\,\Varepsilon(0,\,Q))
        =
        \left\langle
l
,\,
\frac{Ql}{\langle l,\,Ql\rangle^{\nicefrac12}}
        \right\rangle
        =
        \langle l,\,Ql \rangle^{\nicefrac{1}{2}}.
$$
\end{proof}

\begin{definition}
        \textit{Суммой Минковского} множеств $A$ и $B$ называется множество
$$
        A + B
        =
        \{\,
x = a + b \::\: a \in A,\,b \in B 
        \,\}.
$$
\end{definition}

\begin{assertion}
        Опорная функция суммы Минковского равна сумме опорных функций каждого из множеств, то есть
$$
        \rho\left(l\,\left|\,\sum_{i=1}^n A_i\right.\right) = \sum_{i=1}^n \rho\,(l\,|\,A_i).
$$
\end{assertion}
\clearpage
\begin{figure}[t]
        \centering
        \input{img/ellipse}
        \caption{Эллипсоид с центром $q = \protect\begin{bmatrix}1\\2\protect\end{bmatrix}$ и матрицей $Q = \protect\begin{bmatrix}5&3\\3&2\protect\end{bmatrix}.$}
\end{figure}
\begin{figure}[b]
        \centering
        \input{img/sum_ellipse}
        \caption{Сумма двух эллипсоидов.}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\section{Внешняя оценка суммы эллипсоидов}

\begin{theorem}
        Для суммы Минковского эллипсоидов справедлива следующая внешняя оценка
$$
        \sum\limits_{i=1}^{n} \Varepsilon(q_i,\,Q_i)
        =
        \bigcap\limits_{\| l \| = 1} \Varepsilon(q_+(l),\,Q_+(l)),
$$
где
$$
        \begin{aligned}
q_+(l) &= \sum_{i=1}^{n} q_i,
\\
Q_+(l) &= \sum_{i=1}^n p_i \cdot \sum_{i=1}^{n} \frac{Q_i}{p_i},
\quad
\mbox{где }
p_i = \langle l,\,Q_i l \rangle^{\nicefrac12}.
        \end{aligned}
$$
\end{theorem}

\begin{proof}

Будем доказывать для случая $q_i = 0,$ $i = \overline{1,\,n}$. Случай с произвольными центрами~--- аналогично.

Распишем квадрат опорной функции эллипсоида $\Varepsilon(0,\,Q_+(l))$:
\begin{multline*}
        \rho^2(l\,|\,\Varepsilon(0,\,Q_+(l)))
        =
        \sum_{i=1}^{n}
        \langle
        l,\,Q_il
        \rangle
        +
        \sum_{i < j}
        \left\langle
l,\,\left(
\frac{p_i}{p_j}Q_j + \frac{p_j}{p_i}Q_i
\right)l
        \right\rangle
        \geqslant\\\geqslant
        \left\{
\frac{a+b}{2} \geqslant \sqrt{ab}
        \right\}
        \geqslant
        \sum_{i=1}^{n}\langle l,\,Ql \rangle
        +
        2\sum_{i < j}
        \langle l,\,Q_il \rangle^{\nicefrac12}
        \langle l,\,Q_jl \rangle^{\nicefrac12}
        =\\=
        \left(
\sum_{i=1}^n\langle l,\,Q_il\rangle^{\nicefrac12}
        \right)^2
        =
        \rho^2\left(
l\left|
        \sum_{i=1}^n\Varepsilon(0, Q_i)
\right.
        \right).
\end{multline*}
Таким образом, получили, что для любого $l \neq 0$
$$
        \sum_{i=1}^n \Varepsilon(0,\,Q_i) \subseteq \Varepsilon(0,\,Q_+(l)),
$$
причем, так как равенство опорных функций достигается при
$
        p_i = \langle l,\,Q_i l \rangle^{\nicefrac12},
$
то в направлении $l \neq 0$ эллипсоид $\Varepsilon(0,\,Q_+)$ касается суммы $\sum_{i = 0}^{n} \Varepsilon(0,\,Q_i).$

\end{proof}

\clearpage
\begin{figure}[t]
        \centering
        \input{img/outer_sum_10}
        \caption{Эллипсоидальные аппроксимации для 10 направлений.}
\end{figure}
\begin{figure}[b]
        \centering
        \input{img/outer_sum_100}
        \caption{Эллипсоидальные аппроксимации для 100 направлений.}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\section{Внутренняя оценка суммы эллипсоидов}

\begin{definition}
        \textit{Сингулярным разложением} матрицы $A \in \setR^{n \times m}$ называется представление матрицы в виде
$$
        A = V \mathit{\Sigma} U^*, 
$$
        где
$$
\begin{aligned}
&V \in \setR^{n \times n}\::\: V^* = V^{-1},\\
&U \in \setR^{m \times m}\::\: U^* = U^{-1},\\
&\mathit{\Sigma} = \mathrm{diag}\left(\sigma_1,\,\ldots,\,\sigma_{\min\{n,\,m\}}\right) \in \setR^{n \times m}\::\:\sigma_1 \geqslant \sigma_2 \geqslant \ldots \geqslant \sigma_{\min\{n,\,m\}}.
\end{aligned}
$$ 
\end{definition}

\begin{theorem}
        Сингулярное разложение
        $A = V \mathit{\Sigma} U^*$
        существует для любой комплексной матрицы $A$.
        Если матрица $A$ вещественная, то матрицы $V$, $\mathit{\Sigma}$ и $U$ также можно выбрать вещественными. 
\end{theorem}

\begin{theorem}
        Старшее сингулярное число $\sigma_1$ матрицы $A = V \mathit{\Sigma} U^*$ является её нормой.
\end{theorem}

\begin{definition}
        Назовём линейное преобразование $\mathcal{A}$ \textit{ортогональным}, если оно сохраняет скалярное произведение, то есть
$$
        \langle \mathcal{A}(x),\,\mathcal{A}(y)\rangle = \langle x,\,y\rangle.
$$
\end{definition}

\begin{theorem}\label{th:unitarnost}
        Необходимым и достаточным условием ортогональности линейного преобразования $\mathcal{A}$ в конечномерном пространстве является унитарность матрицы преобразования $A$, то есть
$$
        A^* = A^{-1}.
$$
\end{theorem}

\begin{assertion}
        Для произвольных векторов $a,\,b\in\setR^{n}$ таких, что $\|a\| = \|b\|$, существует матрица ортогонального преобразования, переводящего $a$ в $b$.
\end{assertion}
\begin{proof}
        
        Построим сингулярное разложение для векторов $a$ и $b$:
$$
        a = V_a \mathit{\Sigma}_a u_a,
        \qquad
        b = V_b \mathit{\Sigma}_b u_b,
$$        
причем $V_a,\,V_b \in \setR^{n \times n}$~--- унитарные матрицы, $u_a,\,u_b\in\{-1,\,1\}\in\setR^1$,
$$
        \mathit{\Sigma}_a = [\sigma_a,\,0,\,\ldots,\,0]\T\in\setR^{n \times 1},\quad
        \mathit{\Sigma}_b = [\sigma_b,\,0,\,\ldots,\,0]\T\in\setR^{n \times 1},\quad
        \sigma_a,\,\sigma_b > 0.
$$
Согласно Теореме~\ref{th:unitarnost} $\sigma_a = \sigma_b$.
Тогда преобразуем выражение для вектора $b$:
\begin{multline*}
        b
        =
        V_b \mathit{\Sigma}_b u_b
        =
        V_b (V_a\T V_a)\mathit{\Sigma}_b u_b
        =
        V_bV_a\T V_a \left( \mathit{\Sigma}_a \frac{\sigma_b}{\sigma_a} \right) \left( u_a\frac{u_b}{u_a} \right)
        =\\=
        V_bV_a\T \frac{\sigma_b\cdot u_b}{\sigma_a\cdot u_a}V_a\mathit{\Sigma}_au_a
        =
        \left(V_b V_a\T \frac{\sigma_b\cdot u_b}{\sigma_a\cdot u_a}\right)a.
\end{multline*}
Так как произведение унитарных матриц есть унитарная матрица, теорема доказана.

\end{proof}

\textbf{Следствие 1.} Далее под ортогональным преобразованием из вектора $a$ в вектор $b$ таких, что $\|a\| = \|b\|$, будем понимать
$$
        \mathrm{Orth}(a,\,b) = u_au_bV_bV_a\T.
$$

\begin{assertion}
        Для суммы Минковского эллипсоидов справедлива следующая оценка
$$
        \sum_{i=1}^n \Varepsilon(q_i,\,Q_i) = 
        \bigcup\limits_{\|l\|=1}\Varepsilon(q_-(l),\,Q_-(l)),
$$
        где
$$
        \begin{aligned}
q_-(l) &= \sum_{i=1}^n q_i,
\\
Q_-(l) &= Q_*\T(l) Q_*(l),
\quad
Q_*(l) = \sum_{i=1}^{n}S_i(l)Q_i^{\nicefrac12},
\\
S_i(l) &= \mathrm{Orth}(Q_i^{\nicefrac12}l,\,\lambda_iQ_1^{\nicefrac12}l),
\quad
\lambda_i = \frac{\langle l,\,Q_il\rangle^{\nicefrac12}}{\langle l,\,Q_1l\rangle^{\nicefrac12}}.
        \end{aligned}
$$
\end{assertion}

\begin{proof}

Будем доказывать для случая $q_i = 0$, $i=\overline{1,\,n}$.
Случай с произвольными центрами~--- аналогично.

Итак рассмотрим эллипсоид $\Varepsilon_- = \Varepsilon(0,\,Q_-)$, $Q_- = Q_*\T Q_*$,
$$
        Q_* = \sum_{i=1}^n S_i Q_i^{\nicefrac12},
$$
где $S_i$~--- некоторые унитарные матрицы. Распишем квадрат опорной функции этого эллипсоида:
\begin{multline*}
        \rho^2(l\,|\,\Varepsilon_-)
        =
        \langle l,\,Q_-l \rangle
        =
        \langle Q_*l,\,Q_*l \rangle
        =
        \sum_{i=1}^n \langle l,\,Q_il \rangle
        +
        \sum_{i \neq j} \left \langle
        S_i Q_i^{\nicefrac12}l,\, S_j Q_j^{\nicefrac12}l
        \right\rangle
        \leqslant\\\leqslant
        \{
        \mbox{Неравенство Коши--Буняковского}
        \}
        \leqslant\\\leqslant
        \sum_{i=1}^n \langle l,\,Q_il \rangle
        +
        \sum_{i \neq j}
        \langle l,\,Q_il \rangle^{\nicefrac12}
        \langle l,\,Q_jl \rangle^{\nicefrac12}
        =
        \left(
        \sum_{i=1}^n \langle l,\,Q_il \rangle^{\nicefrac12}
        \right)^2
        =
        \rho^2\left(
        l\left|
        \sum_{i=1}^n \Varepsilon(q_i,\,Q_i)
        \right.
        \right).
\end{multline*}
Таким образом, получили, что $\Varepsilon_-\subseteq\sum_{i=1}^n\Varepsilon(q_i,\,Q_i)$.

Заметим, что равенство в последней формуле при фиксированном направлении $l \neq 0$ достигается при
$$
        S_iQ_i^{\nicefrac12}l = \lambda_i S_1Q_1^{\nicefrac12}l, 
$$
где $\lambda_i$~--- произвольные неотрицательные константы. Если положить $S_1 = I$, а $\lambda_i$ выбирать, исходя из условий нормировки ($\|Q_i^{\nicefrac12}l\| = \|\lambda_iQ_1^{\nicefrac12}l\|$):
$$
        \lambda_i = \frac{\langle l,\,Q_il\rangle^{\nicefrac12}}{\langle l,\,Q_1l\rangle^{\nicefrac12}},
$$
то получим утверждение теоремы.

\end{proof}
\vfill
\begin{figure}[h]

        \centering
        \input{img/inner_sum_10}
        \caption{Эллипсоидальные аппроксимации для 10 направлений.}
\end{figure}
\clearpage
\begin{figure}[t]

        \centering
        \input{img/inner_sum_100}
        \caption{Эллипсоидальные аппроксимации для 100 направлений.}
\end{figure}
\begin{figure}[b]

        \centering
        \input{img/outer_and_inner_sum_50}
        \caption{Эллипсоидальные аппроксимации для 50 направлений.}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Document end


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\clearpage
\begin{thebibliography}{9}
\input{bib}
\end{thebibliography}
\end{document}